# For each module in the array $modules, it will search for the module, and install it if it's not installed
# V1.01 - Wrapped in a function for portability

# Function: Check for required modules, install them if missing
function Install-Modules {

    $modules = @(
        "Microsoft.Graph.Users",
        "ExchangeOnlineManagement"
)

    foreach ($module in $modules) {
        if (-not (Get-Module -ListAvailable -Name $module)) {
            Write-Host "Installing module: $module..."
            Install-Module $module -Scope CurrentUser -Force
     } else {
          Write-Host "Module already installed: $module"
      }
     Import-Module $module -Force
    }
}
